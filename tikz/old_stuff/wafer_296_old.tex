%\documentclass[border = 3mm,
%               tikz]{standalone}
\documentclass{article}
\usepackage{tikz}
\usepackage{siunitx}
\usepackage{forest}
\usepackage{cleveref}
\usetikzlibrary{arrows.meta,shapes,positioning}
\usepackage{../themeKonstanz}

\begin{document}
\begin{figure}
    \pgfdeclarelayer{bg}    % declare background layer
    \pgfsetlayers{bg,main}  % set the order of the layers (main is the standard layer)
    \tikzset{
        full/.style={circle,draw,inner sep=0, minimum size=1mm,fill=black},
        every node/.style={minimum height=5mm},
        grid/.style={very thin,gray}
    }
    \centering
    \begin{forest}
        [{Wafer 296\\ $d = \SI{60}{\micro\meter}$ }, align = center, for tree={fill=yellow!50, boarder}
            [{a, b, c, d, e, f, g, h, i, j, k, l}, name = cp_r, for tree={fill=red!30, parent anchor=east} ,s sep = 3mm, parent, grow=360, 
            for children={%
            l=5cm,
        parent anchor=east,
        child anchor=west,
        edge path={
          \noexpand\path [\forestoption{edge}, thin]
            (!u.parent anchor) + (40pt,0pt) |- (.child anchor)  \forestoption{edge label};
        }}
                [{l\\ $t = \SI{55}{\min}$ }, name = l, align = center, for tree={fill=green!70}]
                [{k\\ $t = \SI{50}{\min}$ }, name = k, align = center, for tree={fill=green!65}]
                [{j\\ $t = \SI{45}{\min}$ }, name = j, align = center, for tree={fill=green!60}]
                [{i\\ $t = \SI{40}{\min}$ }, name = i, align = center, for tree={fill=green!55}]
                [{h\\ $t = \SI{35}{\min}$ }, name = h, align = center, for tree={fill=green!50}]
                [{g\\ $t = \SI{30}{\min}$ }, name = g, align = center, for tree={fill=green!45}]
                [{f\\ $t = \SI{25}{\min}$ }, name = f, align = center, for tree={fill=green!40}]
                [{e\\ $t = \SI{20}{\min}$ }, name = e, align = center, for tree={fill=green!35}]
                [{d\\ $t = \SI{15}{\min}$ }, name = d, align = center, for tree={fill=green!30}]
                [{c\\ $t = \SI{10}{\min}$ }, name = c, align = center, for tree={fill=green!25}]
                [{b\\ $t = \SI{5}{\min}$ }, name = b, align = center, for tree={fill=green!20}]
            ]
        ]
        \coordinate[right = 40pt of cp_r] (cp_right);
        \draw (cp_r) -- (cp_right);
        \node[left = of cp_r, fill=red!30] (a) {a};
        \draw (a) -- (cp_r);
        \coordinate[below left = 40pt of cp_r] (cp_left);
        \coordinate[above = 15pt of b] (b_north);
        \begin{pgfonlayer}{bg}    % select the background layer
            \draw[dashed] (a) -- (cp_left) node[anchor=north] {pores open on one side},;
            \draw[dashed] (cp_r) -- (cp_left) node[anchor=north] {},;
            \draw[dashed] (l) -- (b_north) node[anchor=south] {pores opened for time $t$},;
        \end{pgfonlayer}
        \begin{pgfonlayer}{bg}    % select the background layer
            \clip[draw] (circle) (0,-13) circle (2.4);
            \fill[yellow!50] (circle) (0,-13) circle (2.4);
            %
            \fill[cube, fill=red!30] (0,-11) -- (-1,-11) -- (-1,-12) -- (0,-12) -- cycle;
            %
            \fill[cube, fill=green!20] (1,-11) -- (0,-11) -- (0,-12) -- (1,-12) -- cycle;
            %
            \fill[cube, fill=green!25] (2,-12) -- (1,-12) -- (1,-13) -- (2,-13) -- cycle;
            \fill[cube, fill=green!30] (2,-13) -- (1,-13) -- (1,-14) -- (2,-14) -- cycle;
            %
            \fill[cube, fill=green!40] (0,-14) -- (-1,-14) -- (-1,-15) -- (0,-15) -- cycle;
            \fill[cube, fill=green!35] (1,-14) -- (0,-14) -- (0,-15) -- (1,-15) -- cycle;
            %
            \fill[cube, fill=green!50] (-1,-12) -- (-2,-12) -- (-2,-13) -- (-1,-13) -- cycle;
            \fill[cube, fill=green!45] (-1,-13) -- (-2,-13) -- (-2,-14) -- (-1,-14) -- cycle;
            %
            \fill[cube, fill=green!55] (0,-12) -- (-1,-12) -- (-1,-13) -- (0,-13) -- cycle;
            \fill[cube, fill=green!60] (1,-12) -- (0,-12) -- (0,-13) -- (1,-13) -- cycle;
            %
            \fill[cube, fill=green!70] (0,-13) -- (-1,-13) -- (-1,-14) -- (0,-14) -- cycle;
            \fill[cube, fill=green!65] (1,-13) -- (0,-13) -- (0,-14) -- (1,-14) -- cycle;
            %
            \node at (-0.5,-11.5) {a};
            \node at (0.5,-11.5) {b};
            \node at (1.5,-12.5) {c};
            \node at (1.5,-13.5) {d};
            \node at (0.5,-14.5) {e};
            \node at (-0.5,-14.5) {f};
            \node at (-1.5,-13.5) {g};
            \node at (-1.5,-12.5) {h};
            \node at (-0.5,-12.5) {i};
            \node at (0.5,-12.5) {j};
            \node at (0.5,-13.5) {l};
            \node at (-0.5,-13.5) {k};
            \draw[step=1] (-3,-16) grid (3,-10);
        \end{pgfonlayer}
    \end{forest}
    \caption{Wafer 296 processing plan. Of each membrane MEB views will be taken and it will be placed inside the cell for an isotherm.}
    \label{fig:my_label}
\end{figure}
\end{document}