\documentclass[../../thesis.tex]{subfiles}


\begin{document}
\begin{figure}[ht]
    \centering
    \pgfdeclarelayer{bg}    % declare background layer
    \pgfdeclarelayer{bbg}    % declare backbackground layer
    \pgfsetlayers{bbg,bg,main}  % set the order of the layers (main is the standard layer)
    \tikzsetnextfilename{setup_bypass}
    \begin{tikzpicture}
        %objects
        \draw[color=orange!60,line width=1mm,fill = white] decorate[decoration={snake},decorate] {(0,2) -- (2,2)} -- (2,1) -- (0,1) -- (0,2);
        \node at (1,1.5) {$T_\mathrm{res}$};
        \node at (1,0.5) {Reservoir};
        \draw[color=orange!60,line width=1mm] (0,2) -- (0,3);
        \draw[color=orange!60,line width=1mm] (2,2) -- (2,3);
        \draw[color=orange!60,line width=1mm] (4,3) -- (4.5,3.5) -- (4,4) -- cycle;
        \draw[color=blue!60,line width=1mm] (5,4) -- (4.5,3.5) -- (5,3) -- cycle;
        \node at (4.5,2.7) {$V_1$};
        \draw[color=blue!60,line width=1mm] (6,1) -- (7,2) -- (7,1) -- (6,2) -- cycle;
        \node at (6.5,0.7) {$V_2$};
        \draw[color=blue!60,line width=1mm] (8,3) -- (8.5,3.5) -- (8,4) -- cycle;
        \draw[color=red!60,line width=1mm] (9,4) -- (8.5,3.5) -- (9,3) -- cycle;
        \node at (8.5,2.7) {$V_3$};
        \draw[color=blue!60,line width=1mm] (8,6) -- (8.5,5.5) -- (8,5) -- cycle;
        \draw[color=red!60,line width=1mm] (9,6) -- (8.5,5.5) -- (9,5) -- cycle;
        \fill[circle, gray] (8.5,5.5) circle (0.25);
        \draw[color=red!60,line width=1mm] (12,3.5) circle (1);
        \draw[color=red!60,line width=1mm] (11.5,3) rectangle (12.5,4);
        \node at (12,3.5) {$T_\mathrm{cell}$};
        \draw[color=blue!60, line width=1mm] (10,1) -- (9,1) -- (9,2) -- (10,2);
        \node at (14,5.5) {$P_\mathrm{cell}$};
        \draw[rectangle, color = red!60, line width=1mm] (13.5,5) rectangle (14.5,6);
        \draw[rectangle, color=blue!60, line width=1mm] (4,5) rectangle (5,6);
        \node at (4.5,5.5) {$P_\mathrm{res}$};
        \node at (9.5,0.5) {Void};
        \node at (12,2) {Cell};
        \node at (8.5,6.5) {\textsc{Pfeiffer} microvalve};
        %pipes
        \begin{pgfonlayer}{bg}    % select the background layer
            \draw[color=orange!60, line width=1mm] (1,1.5) -- (1,3.5) -- (4,3.5);
            \draw[color=blue!60,line width=1mm] (5,3.5) -- (8,3.5);
            \draw[color = red!60, line width=1mm] (9,3.5) -- (11,3.5);
            \draw[color = red!60, line width=1mm] (13,3.5) -- (14,3.5) -- (14,5);
            \draw[color=blue!60,line width=1mm] (6.5,1.5) -- (6.5,5.5);
            \draw[color=blue!60,line width=1mm] (7,1.5) -- (9,1.5);
            \draw[color=blue!60,line width=1mm] (8,5.5) -- (5,5.5);
            \draw[color = red!50, line width=1mm] (9,5.5) -- (10,5.5) -- (10,3.5);
        \end{pgfonlayer}
        %\begin{pgfonlayer}{bbg}    % select the background layer
        %    \draw[color = red!60, line width=2mm] (8.5,6) -- (8.5,2.5) -- (11,2.5) %-- (11,1) -- (15,1) -- (15,6) -- cycle;
        %\end{pgfonlayer}
    \end{tikzpicture}
    \caption{Experiment setup with bypass which allows to pump the whole system without changing the opening of the \textsc{Pfeiffer} microvalve. The temperatures within the reservoir and the cell are measured by the thermometers $T_\mathrm{res}$ and $T_\mathrm{cell}$. Furthermore, $P_\mathrm{res}$ and $P_\mathrm{cell}$ are the two installed pressure gauges. The void is experimentally realized by a primary pump.}
    \label{fig:setup-bypass}
\end{figure}
\end{document}
